{% extends 'main/base.html' %}
{% load static %}

{% block title %}–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ - LetsPlay{% endblock %}

{% block content %}
<div class="pt-24 pb-16 min-h-screen">
    <div class="container mx-auto px-4 max-w-4xl">
        <h1 class="text-white text-center mb-12">–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h1>

        <div class="grid lg:grid-cols-2 gap-8">
            <!-- Order Form -->
            <div class="bg-white/5 backdrop-blur-xl border-2 border-white/10 rounded-2xl p-8">
                <h2 class="text-white mb-6">–ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h2>

                <form method="post" class="space-y-6">
                    {% csrf_token %}

                    <!-- Name -->
                    <div>
                        <label for="name" class="block text-white mb-2">–ò–º—è *</label>
                        <input type="text"
                               id="name"
                               name="name"
                               required
                               class="w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white focus:border-[#00BCD4] focus:outline-none">
                    </div>

                    <!-- Phone -->
                    <div>
                        <label for="phone" class="block text-white mb-2">–¢–µ–ª–µ—Ñ–æ–Ω *</label>
                        <input type="tel"
                               id="phone"
                               name="phone"
                               required
                               placeholder="+7 (999) 999-99-99"
                               class="w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white focus:border-[#00BCD4] focus:outline-none">
                    </div>

                    <!-- Email -->
                    <div>
                        <label for="email" class="block text-white mb-2">Email *</label>
                        <input type="email"
                               id="email"
                               name="email"
                               required
                               class="w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white focus:border-[#00BCD4] focus:outline-none">
                    </div>

                    <!-- Delivery Method -->
                    <div>
                        <label class="block text-white mb-2">–°–ø–æ—Å–æ–± –¥–æ—Å—Ç–∞–≤–∫–∏ *</label>
                        <div class="space-y-2">
                            <label class="flex items-center gap-3 p-4 bg-white/10 rounded-xl cursor-pointer hover:bg-white/20 transition-colors">
                                <input type="radio" name="delivery_method" value="pickup" checked class="text-[#00BCD4]">
                                <div>
                                    <div class="text-white">–°–∞–º–æ–≤—ã–≤–æ–∑</div>
                                    <div class="text-white/60 text-sm">—É–ª. –¢—É—Ä–≥–µ–Ω–µ–≤–∞, 3, –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥</div>
                                </div>
                            </label>
                            <label class="flex items-center gap-3 p-4 bg-white/10 rounded-xl cursor-pointer hover:bg-white/20 transition-colors">
                                <input type="radio" name="delivery_method" value="courier" class="text-[#00BCD4]">
                                <div>
                                    <div class="text-white">–ö—É—Ä—å–µ—Ä</div>
                                    <div class="text-white/60 text-sm">–ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ –ø–æ –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥—É</div>
                                </div>
                            </label>
                            <label class="flex items-center gap-3 p-4 bg-white/10 rounded-xl cursor-pointer hover:bg-white/20 transition-colors">
                                <input type="radio" name="delivery_method" value="post" class="text-[#00BCD4]">
                                <div>
                                    <div class="text-white">–ö—É—Ä—å–µ—Ä—Å–∫–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ (–°–¥—ç–∫, –ø–æ—á—Ç–∞ —Ä–æ—Å—Å–∏–∏, –Ø–Ω–¥–µ–∫—Å –º–∞—Ä–∫–µ—Ç)</div>
                                    <div class="text-white/60 text-sm">–î–æ—Å—Ç–∞–≤–∫–∞ –≤ –ª—é–±–æ–π –≥–æ—Ä–æ–¥</div>
                                </div>
                            </label>
                        </div>
                    </div>

                    <!-- Address -->
                    <div id="address-field" style="display: none;">
                        <label for="address" class="block text-white mb-2">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ *</label>
                        <textarea id="address"
                                  name="address"
                                  rows="3"
                                  class="w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white focus:border-[#00BCD4] focus:outline-none"></textarea>
                    </div>

                    <!-- Payment Method -->
                    <div>
                        <label class="block text-white mb-2">–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã *</label>
                        <div class="space-y-2">
                            <label class="flex items-center gap-3 p-4 bg-white/10 rounded-xl cursor-pointer hover:bg-white/20 transition-colors">
                                <input type="radio" name="payment_method" value="cash" checked class="text-[#00BCD4]">
                                <span class="text-white">–ù–∞–ª–∏—á–Ω—ã–µ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏</span>
                            </label>
                            <label class="flex items-center gap-3 p-4 bg-white/10 rounded-xl cursor-pointer hover:bg-white/20 transition-colors">
                                <input type="radio" name="payment_method" value="card" class="text-[#00BCD4]">
                                <span class="text-white">–ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞</span>
                            </label>
                            <label class="flex items-center gap-3 p-4 bg-white/10 rounded-xl cursor-pointer hover:bg-white/20 transition-colors">
                                <input type="radio" name="payment_method" value="online" class="text-[#00BCD4]">
                                <span class="text-white">–û–Ω–ª–∞–π–Ω-–æ–ø–ª–∞—Ç–∞</span>
                            </label>
                        </div>
                    </div>

                    <!-- Comment -->
                    <div>
                        <label for="comment" class="block text-white mb-2">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</label>
                        <textarea id="comment"
                                  name="comment"
                                  rows="3"
                                  placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∫ –∑–∞–∫–∞–∑—É"
                                  class="w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white focus:border-[#00BCD4] focus:outline-none"></textarea>
                    </div>

                    <!-- Submit Button -->
                    <button type="submit"
                            class="w-full bg-[#00BCD4] hover:bg-[#00ACC1] text-white py-4 rounded-xl transition-colors">
                        –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑ –Ω–∞ {{ total_price|floatformat:0 }} ‚ÇΩ
                    </button>
                </form>
            </div>

            <!-- Order Summary -->
            <div>
                <div class="bg-white/5 backdrop-blur-xl border-2 border-white/10 rounded-2xl p-6 sticky top-24">
                    <h3 class="text-white mb-4">–í–∞—à –∑–∞–∫–∞–∑</h3>

                    <!-- Items -->
                    <div class="space-y-3 mb-6 max-h-96 overflow-y-auto">
                        {% for item in cart_items %}
                        <div class="flex gap-3 pb-3 border-b border-white/10">
                            <img src="{{ item.product.get_image_url }}"
                                 alt="{{ item.product.name }}"
                                 class="w-16 h-16 rounded-lg object-cover">
                            <div class="flex-1">
                                <div class="text-white text-sm">{{ item.product.name }}</div>
                                <div class="text-white/60 text-xs">{{ item.quantity }} —à—Ç.</div>
                            </div>
                            <div class="text-[#00BCD4]">
                                {{ item.get_total_price|floatformat:0 }} ‚ÇΩ
                            </div>
                        </div>
                        {% endfor %}
                    </div>

                    <!-- Total -->
                    <div class="space-y-3 pt-4 border-t border-white/10">
                        <div class="flex justify-between text-white/70">
                            <span>–¢–æ–≤–∞—Ä—ã ({{ total_items }})</span>
                            <span>{{ total_price|floatformat:0 }} ‚ÇΩ</span>
                        </div>
                        <div class="flex justify-between text-white/70">
                            <span>–î–æ—Å—Ç–∞–≤–∫–∞</span>
                            <span class="text-green-400">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</span>
                        </div>
                        <div class="flex justify-between pt-3 border-t border-white/10">
                            <span class="text-white">–ò—Ç–æ–≥–æ:</span>
                            <span class="text-[#00BCD4] text-2xl">{{ total_price|floatformat:0 }} ‚ÇΩ</span>
                        </div>
                    </div>

                    <!-- Advantages -->
                    <div class="mt-6 pt-6 border-t border-white/10 space-y-3">
                        <div class="flex items-center gap-3 text-sm text-white/70">
                            <span class="text-xl">üõ°Ô∏è</span>
                            <span>–ì–∞—Ä–∞–Ω—Ç–∏—è 1 –≥–æ–¥</span>
                        </div>
                        <div class="flex items-center gap-3 text-sm text-white/70">
                            <span class="text-xl">üöö</span>
                            <span>–ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞</span>
                        </div>
                        <div class="flex items-center gap-3 text-sm text-white/70">
                            <span class="text-xl">‚Ü©Ô∏è</span>
                            <span>–û–±–º–µ–Ω 14 –¥–Ω–µ–π</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Show/hide address field based on delivery method
document.querySelectorAll('input[name="delivery_method"]').forEach(radio => {
    radio.addEventListener('change', function() {
        const addressField = document.getElementById('address-field');
        const addressInput = document.getElementById('address');

        if (this.value === 'courier' || this.value === 'post') {
            addressField.style.display = 'block';
            addressInput.required = true;
        } else {
            addressField.style.display = 'none';
            addressInput.required = false;
        }
    });
});



  const form = document.getElementById('checkout-form');
  const btn = document.getElementById('checkout-submit');

  form.addEventListener('submit', function () {
    btn.disabled = true;
    btn.innerText = '–û—Ñ–æ—Ä–º–ª—è–µ–º –∑–∞–∫–∞–∑...';
  });
</script>
{% endblock %}
